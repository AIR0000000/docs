---
sidebar_title: Intent Based
page_title: UMAP - Mandates - Intent Based Single Block Multi Debit Mandate
order: 1
visible_in_sidebar: true
---

## Intent Based Single Block Multi Debit Mandate

Steps to collect a payment via an intent based single block multi debit mandate

<hr class="primary" />

#### Step 1 - create an intent based single block multi debit mandate

The process for mandate creation is described in the below diagram:

<img
  src="https://storage.googleapis.com/strapi-assets/latest/intent-based-mandate-create/intent-based-mandate-create.png"
  alt="Bridge"
/>

The merchant will have to call the **<i>create mandate API</i>** with the correct set of parameters.

<table>
    <tbody>
        <tr>
            <th>Staging Host</th>
            <td>
                <code>https://umap-dev-core.setu.co/api/v1</code>
            </td>
        </tr>
        <tr>
            <th>Method</th>
            <td>
                <code>POST</code>
            </td>
        </tr>
        <tr>
            <th>Path</th>
            <td>
                <code>/merchants/mandates</code>
            </td>
        </tr>
        <tr>
            <th>Header</th>
            <td>
                <code>merchantId</code><br/>
                <code>Authorization</code>: Bearer &lt;<b>insert_token_here</b>&gt;.
                Generate this token using <a
                    href="/payments/upi-deeplinks/resources/oauth"
                    target="_blank">
                    OAuth
                </a> or <a
                    href="/payments/upi-deeplinks/resources/jwt"
                    target="_blank">
                    JWT
                </a>.<br />
                <br />
                <code>Content-Type</code>—will be <code>application/json</code>
            </td>
        </tr>
    </tbody>
</table>

###### Sample request

<CodeBlockWithCopy language="json">
    {`{
    "allowMultipleDebit": true,
    "amount": 1000,
    "amountRule": "max",
    "autoExecute": false,
    "autoPreNotify": false,
    "blockFunds": true,
    "creationMode": "qr",
    "currency": "INR",
    "customerRevocable": false,
    "customerVpa": "ram@axis",
    "endDate": "02012008",
    "expireAfter": 120,
    "firstExecutionAmount": 0,
    "frequency": "as presented",
    "initiationMode": "01",
    "maxAmountLimit": 1000,
    "merchantReferenceId": "ABC1234789",
    "merchantVpa": "acme.corp@axis",
    "productConfigId": "01ARZ3NDEKTSV4RRFFQ69G5FAV",
    "purpose": "76",
    "recurrenceRule": "on",
    "recurrenceValue": 0,
    "shareToPayee": false,
    "startDate": "02012006",
    "transactionNote": "Transaction note"
}`}
</CodeBlockWithCopy>

<Callout type="warning">
    <ul>
        <li>The value of <code>frequency</code> must be <code>as presented</code> for creating a single block multi debit mandate.</li>
        <li>The value of <code>creationMode</code> must be <code>qr</code> or <code>intent</code> for creating a single block multi debit mandate.</li>
        <li>The value of <code>initiationMode</code> must be <code>01</code> if <code>creationMode</code> is <code>qr</code></li>
        <li>The value of <code>initiationMode</code> must be <code>04</code> if{" "} <code>creationMode</code> is{" "}<code>intent</code></li>
        <li>The value of <code>recurrenceRule</code> must be <code>on</code> for creating a single block multi debit mandate.</li>
        <li>The value of <code>recurrenceValue</code> must be <code>0</code> for creating a single block multi debit mandate.</li>
        <li>The value of <code>autoExecute</code> and <code>autoPreNotify</code> must be <code>false</code> for creating a single block multi debit mandate.</li>
        <li>The value of <code>blockFunds</code> and <code>allowMultipleDebit</code> must be <code>true</code> for creating a single block multi debit mandate.</li>
        <li>The value of <code>purpose</code> must be <code>76</code> for creating a single block multi debit mandate.</li>
        <li>The value of <code>customerRevocable</code> must be <code>false</code> for creating a single block multi debit mandate.</li>
    </ul>
</Callout>

###### Sample response

<CodeBlockWithCopy language="json">
    {`{
  "allowMultipleDebit": true,
  "amount": 1000,
  "amountRule": "max",
  "autoExecute": false,
  "autoPreNotify": false,
  "blockFunds": true,
  "createdAt": "2023-09-04 12:08:20.202644 +0530 IST",
  "creationMode": "qr",
  "currency": "INR",
  "customerRevocable": false,
  "customerVpa": "ram@axis",
  "endDate": "02012008",
  "expireAfter": 120,
  "firstExecutionAmount": 0,
  "frequency": "single block multi debit",
  "id": "01ARZ3NDEKTSV4RRFFQ69G5FAV",
  "initiationMode": "01",
  "intentLink": "upi://mandate?pa=acme.corp@axis&pn=merchant-1&validitystart=02012006&validityend=02012008&am=100.00&amrule=MAX&recur=ASPRESENTED&tr=BTTZrc5gDFkuCr3n3I0ey4aNtzLOLR7K7aR&cu=INR&mc=1234&mode=01&purpose=76&rev=N&share=N&qrexpire=02012006&block=Y&orgid=409214&version=2.0&txnType=CREATE&tid=BTTZrc5gDFkuCr3n3I0ey4aNtzLOLR7K7aR",
  "maxAmountLimit": 1000,
  "merchantId": "01ARZ3NDEKTSV4RRFFQ69G5FAV",
  "merchantReferenceId": "ABC1234789",
  "merchantVpa": "acme.corp@axis",
  "productConfigId": "01ARZ3NDEKTSV4RRFFQ69G5FAV",
  "purpose": "76",
  "recurrenceRule": "on",
  "recurrenceValue": 0,
  "shareToPayee": false,
  "startDate": "02012006",
  "status": "pending",
  "transactionNote": "Transaction note",
  "txnId": "BTTZrc5gDFkuCr3n3I0ey4aNtzLOLR7K7aR"
}`}
</CodeBlockWithCopy>

**In the above response:**

-   `intentLink` or corresponding qr can be shared directly with customers via a communication channel.
-   `id` is a unique mandate ID that is associated with this mandate and can be used to track it later.

This request to generate a mandate creation intent link / qr is flexible and allows for many use cases. To know more about all the API params, please refer to the API documentation <a href="/payments/umap/api-reference#/category~mandates/operation~mandates#create" target="_blank">here</a>.

Post this, once the customer clicks on the intent link / scans the qr code and enters the mPIN, the merchant will receive webhooks for two events **<i>mandate initiated, mandate registration confirmed.</i>** 

Please refer to the Document Reference section for checking the API reference and the notifications.

<hr class="tertiary" />

#### Step 2 - execute mandate

Once the mandate is **LIVE**, the merchant can execute the mandate whenever a payment is to be collected from the customer.

The process for mandate execution is described in the below diagram:

<img
  src="https://storage.googleapis.com/strapi-assets/latest/mandate-pre-debit-notification/mandate-pre-debit-notification.png"
  alt="Bridge"
/>

The merchant will have to call the **<i>execute mandate API</i>** with the correct set of parameters.

<table>
    <tbody>
        <tr>
            <th>Staging Host</th>
            <td>
                <code>https://umap-dev-core.setu.co/api/v1</code>
            </td>
        </tr>
        <tr>
            <th>Method</th>
            <td>
                <code>POST</code>
            </td>
        </tr>
        <tr>
            <th>Path</th>
            <td>
                <code>/merchants/mandates&#123;mandateId&#125;execute</code>
            </td>
        </tr>
        <tr>
            <th>Header</th>
            <td>
                <code>merchantId</code><br/>
                <code>Authorization</code>: Bearer &lt;<b>insert_token_here</b>&gt;.
                Generate this token using <a
                    href="/payments/upi-deeplinks/resources/oauth"
                    target="_blank">
                    OAuth
                </a> or <a
                    href="/payments/upi-deeplinks/resources/jwt"
                    target="_blank">
                    JWT
                </a>.<br />
                <br />
                <code>Content-Type</code>—will be <code>application/json</code>
            </td>
        </tr>
    </tbody>
</table>

###### Sample request

<CodeBlockWithCopy language="json">
    {`{
    "amount": 1000,
    "merchantReferenceId": "ABC1234789",
    "remark": "Transaction for car loan emi",
    "sequenceNumber": 1,
    "umn": "setumandate1234789@ybl"
}`}
</CodeBlockWithCopy>

<Callout type="warning">
    <ul>
        <li>Note that the value of <code>amount</code> must be such that the cumulative amount debited for the given mandate post current debit is within the amount that is blocked in customer's account</li>
        <li>The value of <code>umn</code> can be derived from the notifications received by the merchant during mandate creation flow or via check mandate status API</li>
    </ul>
</Callout>

###### Sample response

<CodeBlockWithCopy language="json">
    {`{
  "amount": 1000,
  "createdAt": "2023-09-04 12:08:20.202644 +0530 IST",
  "id": "01ARZ3NDEKTSV4RRFFQ69G5FAV",
  "mandateId": "01ARZ3NDEKTSV4RRFFQ69G5FAV",
  "merchantId": "01ARZ3NDEKTSV4RRFFQ69G5FAV",
  "merchantReferenceId": "ABC1234789",
  "remark": "Transaction for car loan emi",
  "sequenceNumber": 1,
  "status": "pending",
  "txnId": "BTTZrc5gDFkuCr3n3I0ey4aNtzLOLR7K7aR",
  "umn": "c27f5fc30d344e9594fce0afa34f8859@mypsp"
}`}
</CodeBlockWithCopy>

**In the above response:**

-   `id` is a unique ID that is associated with this mandate execution and can be used to track it later.

To know more about all the API params, please refer to the API documentation <a href="/payments/umap/api-reference#/category~mandates/operation~mandates#execute" target="_blank">here</a>.

UMAP will send notifications to the merchant once **<i>the execution operation is completed</i>** and **<i>the final status of the mandate.</i>**

Please refer to the Document Reference section for checking the API reference and the notifications.

<hr class="primary" />

Other operations that can be performed on a single block multi debit mandate once it is <b>LIVE</b>
<ul>
    <li>Updating a single block multi debit mandate</li>
    <li>Revoking a single block multi debit mandate</li>
    <li>Pausing a single block multi debit mandate</li>
    <li>Unpausing a paused single block multi debit mandate</li>
</ul>

<hr class="tertiary" />

<NextPage
    info={{
        description: "Other operations that can be performed on a mandate.  ",
        slug: "/payments/umap/mandates/generic",
        title: "Generic Operations",
    }}
/>